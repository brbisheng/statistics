<head>
     <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
     <meta name="description" content="Stata with quantile regression and interpretation, median regression">
     <meta name="keywords" content="stata, quantile regression, median regression, interpretation, distribution, frequency, quantile">
<link rel="stylesheet" href="https://brbisheng.github.io/statistics/mystyle.css">
</head>

<body>

<div class="center" itemprop="text">
     
<p> <span>&#8594;</span> We use the <b>hsb2</b> dataset to give some examples</p>
     
<blockquote>
<pre><b>use https://stats.idre.ucla.edu/stat/stata/notes/hsb2, clear

tabstat write, by(female) stat(p10 p25 p50 p75 p90)</b>

Summary for variables: write
     by categories of: female 

female |       p10       p25       p50       p75       p90
-------+--------------------------------------------------
  male |        37        41        52        59        63
female |        44        50        57        62        65
-------+--------------------------------------------------
 Total |        39      45.5        54        60        65
----------------------------------------------------------</pre>
</blockquote>
     
<p> <span>&#8594;</span> Let us start by running 0.25-th, .50-th, and .75-th quantile regression models without including any predictors.</p>
     
<blockquote>
<pre><b>qreg write, quantile(.25)</b>

Iteration  1:  WLS sum of weighted deviations =  755.39801

Iteration  1: sum of abs. weighted deviations =     767.75
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =     666.75

.25 Quantile regression                             Number of obs =        200
  Raw sum of deviations   666.75 (about 45)
  Min sum of deviations   666.75                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         46   1.197473    38.41   0.000     43.63863    48.36137
------------------------------------------------------------------------------

<b>qreg write, quantile(.50)</b>

Iteration  1:  WLS sum of weighted deviations =  794.11248

Iteration  1: sum of abs. weighted deviations =      795.5
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =      785.5

Median regression                                   Number of obs =        200
  Raw sum of deviations    785.5 (about 54)
  Min sum of deviations    785.5                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         54   1.064059    50.75   0.000     51.90172    56.09828
------------------------------------------------------------------------------

<b>qreg write, quantile(.75)</b>

Iteration  1:  WLS sum of weighted deviations =  690.18668

Iteration  1: sum of abs. weighted deviations =     681.25
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =     542.25

.75 Quantile regression                             Number of obs =        200
  Raw sum of deviations   542.25 (about 60)
  Min sum of deviations   542.25                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         60   .5322104   112.74   0.000      58.9505     61.0495
------------------------------------------------------------------------------</pre>

     <br>
     
</blockquote>
     <p> <span>&#8594;</span>
          <ol>
               <li> In the .25-th quantile regression, the constant is the 25%-th quantile of the response variable for the whole sample. </li>
               <li> In the .50-th quantile regression, the constant is the median of the response variable for the whole sample. </li>
               <li> In the .75-th quantile regression, the constant is the 75%-th quantile of the response variable for the whole sample. </li> 
     </p>

     <p>In the next step, we add an indicator variable <b>female</b> to the model.</p>

<hr>
     
<blockquote>
<pre><b>qreg write female, quantile(0.25)</b>

Iteration  1:  WLS sum of weighted deviations =   723.5401

Iteration  1: sum of abs. weighted deviations =     747.25
Iteration  2: sum of abs. weighted deviations =      697.5
Iteration  3: sum of abs. weighted deviations =      621.5

.25 Quantile regression                             Number of obs =        200
  Raw sum of deviations   666.75 (about 45)
  Min sum of deviations    621.5                    Pseudo R2     =     0.0679

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          9    2.18561     4.12   0.000     4.689938    13.31006
       _cons |         41   1.613508    25.41   0.000     37.81813    44.18187
------------------------------------------------------------------------------

<b>predict pred_p25</b>
(option xb assumed; fitted values)

<b>tabulate pred_p25</b>

     Linear |
 prediction |      Freq.     Percent        Cum.
------------+-----------------------------------
         41 |         91       45.50       45.50
         50 |        109       54.50      100.00
------------+-----------------------------------
      Total |        200      100.00


<b>qreg write female, quantile(.50)</b>

Iteration  1:  WLS sum of weighted deviations =  771.88445

Iteration  1: sum of abs. weighted deviations =      772.5
Iteration  2: sum of abs. weighted deviations =        771
Iteration  3: sum of abs. weighted deviations =        768

Median regression                                   Number of obs =        200
  Raw sum of deviations    785.5 (about 54)
  Min sum of deviations      768                    Pseudo R2     =     0.0223

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          5   2.079097     2.40   0.017     .8999848    9.100015
       _cons |         52   1.534875    33.88   0.000      48.9732     55.0268
------------------------------------------------------------------------------

<b>predict pred_p50</b>
(option xb assumed; fitted values)

<b>tabulate pred_p50</b>

     Linear |
 prediction |      Freq.     Percent        Cum.
------------+-----------------------------------
         52 |         91       45.50       45.50
         57 |        109       54.50      100.00
------------+-----------------------------------
      Total |        200      100.00
</pre>
</blockquote>
     
     <br>

     <p><span>&#8594;</span> Let us take the 0.25-th and median regression models as examples. The interpretation for other quantiles is analogous.</p>
     <p><span>&#8594;</span>
          <ol> 
               <li>For the 0.25-th quantile regression model, with the dummy fariable <b>female</b>, the constant is the 0.25-th quantile for the group coded zero (males) and the coefficient is the difference in the 0.25-th quantile between males and female (see the <b>tabstat pred_p25</b> above, where 9 = 50 - 41). </li>
               <li>For the median quantile regression model, with the dummy fariable <b>female</b>, the constant is the median for the group coded zero (males) and the coefficient is the difference in the median between males and female (see the <b>tabstat pred_p50</b> above, where 5 = 57 - 42). </li>
          </ol>
    </p>

<hr>
     <p> <span>&#8594;</span> Now, we add a continuous predictor in the model.</p>
<blockquote>
<pre><b>qreg write socst, quantile(0.25)</b>

Iteration  1:  WLS sum of weighted deviations =  592.03771

Iteration  1: sum of abs. weighted deviations =  593.01667
Iteration  2: sum of abs. weighted deviations =     514.75
Iteration  3: sum of abs. weighted deviations =  500.53947
Iteration  4: sum of abs. weighted deviations =  487.09211
Iteration  5: sum of abs. weighted deviations =   478.1375
Iteration  6: sum of abs. weighted deviations =   478.1375

.25 Quantile regression                             Number of obs =        200
  Raw sum of deviations   666.75 (about 45)
  Min sum of deviations 478.1375                    Pseudo R2     =     0.2829

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       socst |        .65   .0609586    10.66   0.000     .5297886    .7702114
       _cons |      13.85   3.260551     4.25   0.000     7.420136    20.27986
------------------------------------------------------------------------------

<b>predict pred_p25_continuous</b>
(option xb assumed; fitted values)

<b>qreg write socst, quantile(.50)</b>

Iteration  1:  WLS sum of weighted deviations =  609.49484

Iteration  1: sum of abs. weighted deviations =  609.96667
Iteration  2: sum of abs. weighted deviations =      606.4
Iteration  3: sum of abs. weighted deviations =     604.45
Iteration  4: sum of abs. weighted deviations =     604.45

Median regression                                   Number of obs =        200
  Raw sum of deviations    785.5 (about 54)
  Min sum of deviations   604.45                    Pseudo R2     =     0.2305

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       socst |   .6333333   .0739657     8.56   0.000     .4874717     .779195
       _cons |   20.03333   3.956277     5.06   0.000     12.23149    27.83518
------------------------------------------------------------------------------

<b>predict pred_p50_continuous</b>
(option xb assumed; fitted values)</pre>
     
</blockquote>
     
     <br>

     <p><span>&#8594;</span>If we include the continuous explanatory variable <b>socst</b>, the constant is the the predicted value when <b>socst == 0</b>. The quantile regression coefficient tells us that for every one-unit increase in <b>socst</b>, the predicted value of the response variable <b>write</b> will increase by .65.</p>
     <p><span>&#8594;</span>We can verify the coefficient by listing the predictor with the associated predicted values for any two adjacent values. 
          <ol>
               <li>For example, for the one-unit change from 42 to 43 in <b>socst</b> the predicted value increases by .65. for the 25-th quantile.</li>
               <li>For example, for the one-unit change from 42 to 43 in <b>socst</b> the predicted value increases by .6333. for the 50-th quantile.</li>
          </ol>
     </p>

 <blockquote>
<pre><b>sort socst

list socst pred_p25_continuous pred_p50_continuous in 43/44</b>

     +------------------------------+
     | socst   pred_p25   pred_p50  |
     |------------------------------|
 43. |    42      41.15   46.633333 |
 44. |    43       41.8   47.266667 |
     +------------------------------+
</pre>
</blockquote>
</div>

<div>
<p>&rarr; Some examples:</p>
<ol>
<li>From stata.com: <a href="https://www.stata.com/features/overview/quantile-regression/" target="_blank">Quantile regression</a></li>
<li>From statology.com: <a href="https://www.statology.org/quantile-regression-stata/" target="_blank">How to perform quantile regression in Stata</a></li>
</ol>     
</div>

</body>
<!--- https://stats.idre.ucla.edu/stata/faq/how-do-i-interpret-quantile-regression-coefficients/ --->
