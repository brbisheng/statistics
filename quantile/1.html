<div class="entry-content" itemprop="text">
     
<p>We use the <b>hsb2</b> dataset to give some examples</p>
     
<blockquote>
<pre><b>use https://stats.idre.ucla.edu/stat/stata/notes/hsb2, clear

tabstat write, by(female) stat(p10 p25 p50 p75 p90)</b>

Summary for variables: write
     by categories of: female 

female |       p10       p25       p50       p75       p90
-------+--------------------------------------------------
  male |        37        41        52        59        63
female |        44        50        57        62        65
-------+--------------------------------------------------
 Total |        39      45.5        54        60        65
----------------------------------------------------------</pre>
</blockquote>
     
<p>Let us start by running 0.25, .50, and .75 quantile regression models without including anypredictors.</p>
     
<blockquote>
<pre><b>qreg write, quantile(.25)</b>
Iteration  1:  WLS sum of weighted deviations =  755.39801

Iteration  1: sum of abs. weighted deviations =     767.75
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =     666.75

.25 Quantile regression                             Number of obs =        200
  Raw sum of deviations   666.75 (about 45)
  Min sum of deviations   666.75                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         46   1.197473    38.41   0.000     43.63863    48.36137
------------------------------------------------------------------------------

<b>qreg write, quantile(.50)</b>
Iteration  1:  WLS sum of weighted deviations =  794.11248

Iteration  1: sum of abs. weighted deviations =      795.5
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =      785.5

Median regression                                   Number of obs =        200
  Raw sum of deviations    785.5 (about 54)
  Min sum of deviations    785.5                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         54   1.064059    50.75   0.000     51.90172    56.09828
------------------------------------------------------------------------------

<b>qreg write, quantile(.75)</b>
Iteration  1:  WLS sum of weighted deviations =  690.18668

Iteration  1: sum of abs. weighted deviations =     681.25
note:  alternate solutions exist
Iteration  2: sum of abs. weighted deviations =     542.25

.75 Quantile regression                             Number of obs =        200
  Raw sum of deviations   542.25 (about 60)
  Min sum of deviations   542.25                    Pseudo R2     =     0.0000

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       _cons |         60   .5322104   112.74   0.000      58.9505     61.0495
------------------------------------------------------------------------------</pre>

</blockquote>
     <p>
          <ol>
               <li> In the .25 quantile regression, the constant is the 25% quantile of the response variable for the whole sample. </li>
               <li> In the .50 quantile regression, the constant is the median of the response variable for the whole sample. </li>
               <li> In the .75 quantile regression, the constant is the 75% quantile of the response variable for the whole sample. </li> 
     </p>

     <p>In the next step, we add an indicator variable <b>female</b> to the model.</p>

<blockquote>
<pre><b>qreg write female, quantile(0.25)</b>

Iteration  1:  WLS sum of weighted deviations =  1543.9433

Iteration  1: sum of abs. weighted deviations =       1545
Iteration  2: sum of abs. weighted deviations =       1542
Iteration  3: sum of abs. weighted deviations =       1536

Median regression                                    Number of obs =       200
  Raw sum of deviations     1571 (about 54)
  Min sum of deviations     1536                     Pseudo R2     =    0.0223

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          5   2.611711     1.91   0.057    -.1503394    10.15034
       _cons |         52   1.927268    26.98   0.000     48.19939    55.80061
------------------------------------------------------------------------------

<b>predict p50</b>
(option xb assumed; fitted values)

<b>tabulate p50</b>

     Fitted |
     values |      Freq.     Percent        Cum.
------------+-----------------------------------
         52 |         91       45.50       45.50
         57 |        109       54.50      100.00
------------+-----------------------------------
      Total |        200      100.00

<b>qreg write female, quantile(.75)</b>

Iteration  1:  WLS sum of weighted deviations =  1204.3893

Iteration  1: sum of abs. weighted deviations =       1272
Iteration  2: sum of abs. weighted deviations =     1154.5
Iteration  3: sum of abs. weighted deviations =       1060

75 Quantile regression                              Number of obs =       200
  Raw sum of deviations   1084.5 (about 60)
  Min sum of deviations     1060                     Pseudo R2     =    0.0226

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          3    1.23163     2.44   0.016     .5712035    5.428796
       _cons |         59   .9385943    62.86   0.000     57.14908    60.85092
------------------------------------------------------------------------------

<b>predict p75</b>
(option xb assumed; fitted values)

<b>tabulate p75</b>

     Fitted |
     values |      Freq.     Percent        Cum.
------------+-----------------------------------
         59 |         91       45.50       45.50
         62 |        109       54.50      100.00
------------+-----------------------------------
      Total |        200      100.00</pre>
</blockquote>
<p>From this point on Iâ€™ll describe what is going on in the median regression model.
The interpretation for the .75 quantile regression is basically the same except that you
substitute the term 75th percentile for the term median.</p>
<p>With the binary predictor, the constant is median for group coded zero (males) and the
coefficient is the difference in medians between males and female (see the <b>tabstat</b>
above).</p>
<p>Looking at the tabulated predicted scores we see that we get two values, the conditional median
for males (52) and the conditional median for female (57).</p>
<p>Now, let me show you something that is really neat about quantile regression. I will replace
the highest value of <b>write</b> (67) with the value of 670 and rerun these analyses.</p>
<blockquote>
<pre><b>replace write=670 if write==67</b>
(7 real changes made)

<b>qreg write female</b>

Iteration  1:  WLS sum of weighted deviations =  8319.5083

Iteration  1: sum of abs. weighted deviations =       6544
Iteration  2: sum of abs. weighted deviations =       6156
Iteration  3: sum of abs. weighted deviations =       5757

Median regression                                    Number of obs =       200
  Raw sum of deviations     5792 (about 54)
  Min sum of deviations     5757                     Pseudo R2     =    0.0060

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          5   2.611711     1.91   0.057    -.1503394    10.15034
       _cons |         52   1.927268    26.98   0.000     48.19939    55.80061
------------------------------------------------------------------------------

<b>qreg write female, quantile(.75)</b>

Iteration  1:  WLS sum of weighted deviations =   11445.07

Iteration  1: sum of abs. weighted deviations =       7582
Iteration  2: sum of abs. weighted deviations =       7461
Iteration  3: sum of abs. weighted deviations =     7391.5

75 Quantile regression                              Number of obs =       200
  Raw sum of deviations     7416 (about 60)
  Min sum of deviations   7391.5                     Pseudo R2     =    0.0033

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      female |          3    1.23163     2.44   0.016     .5712035    5.428796
       _cons |         59   .9385943    62.86   0.000     57.14908    60.85092
------------------------------------------------------------------------------</pre>
</blockquote>
<p>Notice that neither the coefficients nor the standard errors changed. This
is because changing this extreme score does not change either the median or the 75th
percentile. The only changes that affect the results are when a value crosses a quantile
boundary. For example, changing a value of 58 to 580 would not affect the median but
would affect the 75th percentile.</p>
<p>For the last example, we will reload the data and use a continuous predictor in the model.</p>
<blockquote>
<pre><b>use https://stats.idre.ucla.edu/stat/stata/notes/hsb2, clear

qreg write socst</b>

Iteration  1:  WLS sum of weighted deviations =  1219.9071

Iteration  1: sum of abs. weighted deviations =  1219.9333
Iteration  2: sum of abs. weighted deviations =     1212.8
Iteration  3: sum of abs. weighted deviations =  1212.5667
Iteration  4: sum of abs. weighted deviations =   1209.375
Iteration  5: sum of abs. weighted deviations =     1208.9

Median regression                                    Number of obs =       200
  Raw sum of deviations     1571 (about 54)
  Min sum of deviations   1208.9                     Pseudo R2     =    0.2305

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       socst |   .6333333   .0571053    11.09   0.000     .5207206    .7459461
       _cons |   20.03333   3.069487     6.53   0.000     13.98025    26.08642
------------------------------------------------------------------------------

<b>predict double p50</b>
(option xb assumed; fitted values)

<b>qreg write socst, quantile(.75)</b>

Iteration  1:  WLS sum of weighted deviations =     992.87

Iteration  1: sum of abs. weighted deviations =  1003.2667
Iteration  2: sum of abs. weighted deviations =     950.85
Iteration  3: sum of abs. weighted deviations =  936.30001
Iteration  4: sum of abs. weighted deviations =  928.66667
Iteration  5: sum of abs. weighted deviations =  926.07501
Iteration  6: sum of abs. weighted deviations =  924.30001

75 Quantile regression                              Number of obs =       200
  Raw sum of deviations   1084.5 (about 60)
  Min sum of deviations    924.3                     Pseudo R2     =    0.1477

------------------------------------------------------------------------------
       write |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
       socst |         .4   .0408158     9.80   0.000     .3195104    .4804896
       _cons |       37.6   2.187081    17.19   0.000     33.28704    41.91296
------------------------------------------------------------------------------

<b>predict double p75</b>
(option xb assumed; fitted values)</pre>
</blockquote>
<p>With the continuous predictor <b>socst</b> the constant is the predicted value when <b>socst</b> is zero. The quantile regression coefficient tells us that for every one unit change in <b>socst</b> that the predicted value of <b>write</b> will increase by .6333333.</p>
<p>We can show this by listing the predictor with the associated predicted values for two adjacent values. Notice that for the one unit change from 41 to 42 in <b>socst</b> the predicted value increases by .633333.</p>
<blockquote>
<pre><b>sort socst

list socst p50 p75 in 42/43</b>

     +--------------------------+
     | socst         p50    p75 |
     |--------------------------|
 42. |    41          46     54 |
 43. |    42   46.633333   54.4 |
     +--------------------------+</pre>
</blockquote>
</div>

<!--- https://stats.idre.ucla.edu/stata/faq/how-do-i-interpret-quantile-regression-coefficients/ --->
